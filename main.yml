---
- hosts: k8s
  remote_user: root
  roles:
    - dnf
    - init
    - containerd
  tags: o

- hosts: master
  tasks:
    - name: 拷贝kubernetes安装文件
      copy:
        src: ./k8s_server/{{ item }}
        dest: /usr/local/bin
        mode: +x
      loop:
        - kube-apiserver
        - kube-controller-manager
        - kubectl
        - kubelet
        - kube-proxy
        - kube-scheduler

- hosts:
    - master
  remote_user: root
  roles:
    - pki
  tags: pki

- hosts:
    - etcd
  remote_user: root
  roles:
    - etcd

- hosts:
    - master
  remote_user: root
  roles:
    - lb
  tags: lb

- hosts:
    - master
  remote_user: root
  roles:
    - master
  tags: m

- hosts:
    - master
  remote_user: root
  roles:
    - bootstrap
  tags: boot

- hosts:
    - k8s
  remote_user: root
  vars:
    m1: 192.168.12.31
  roles:
    - node
  tags: node
